<template>
  <lightning-card title="Upload to S3" icon-name="utility:upload">
    <div class="slds-p-around_medium">

      <!-- Hidden native file input -->
      <input
        type="file"
        multiple
        accept="*/*"
        onchange={handleFileChange}
        class="hidden-file-input"
      />

      <!-- Choose File Button -->
      <lightning-button
        label="Choose File"
        icon-name="utility:attach"
        onclick={openFilePicker}>
      </lightning-button>

      <!-- Selected files list -->
      <template if:true={hasFiles}>
        <div class="slds-m-top_small">
          <template for:each={files} for:item="file" for:index="index">
            <div
              key={file.name}
              class="slds-pill slds-m-bottom_x-small file-pill"
            >
              <span class="slds-pill__label">{file.name}</span>
              <button
                class="slds-button slds-button_icon slds-pill__remove"
                title="Remove"
                data-index={index}
                onclick={removeFile}
              >
                âœ•
              </button>
            </div>
          </template>
        </div>
      </template>

      <!-- Upload button -->
      <div class="slds-m-top_medium slds-text-align_right">
        <lightning-button
          label="Upload"
          variant="brand"
          onclick={upload}
          disabled={isUploadDisabled}>
        </lightning-button>
      </div>

      <!-- Spinner -->
      <template if:true={uploading}>
        <div class="slds-m-top_medium">
          <lightning-spinner alternative-text="Uploading..." size="small">
          </lightning-spinner>
        </div>
      </template>

      <!-- Result message -->
      <template if:true={lastResultMessage}>
        <div class="slds-m-top_small">
          <lightning-formatted-text value={lastResultMessage}>
          </lightning-formatted-text>
        </div>
      </template>

    </div>
  </lightning-card>
</template>