<template>
    <div class="slds-p-around_small">
                <template if:true={showFeedback}>
        <!-- Lead Information Card -->
        <div class="lead-card slds-box slds-m-bottom_medium">
            <div class="section-header">
                <lightning-icon icon-name="standard:lead" size="small"></lightning-icon>
                <span>Lead Information</span>
            </div>

            <div class="section-content">
                <div class="info-line">
                    <lightning-icon icon-name="utility:user" size="x-small"></lightning-icon>
                    <span>{identity.name}</span>
                </div>

                <div class="info-line">
                    <lightning-icon icon-name="utility:email" size="x-small"></lightning-icon>
                    <span>{identity.email}</span>
                </div>

                <div class="info-line">
                    <lightning-icon icon-name="utility:phone_portrait" size="x-small"></lightning-icon>
                    <span>{identity.phone}</span>
                </div>

                <div class="grid-2">
                    <div class="info-line">
                        <lightning-icon icon-name="utility:location" size="x-small"></lightning-icon>
                        <span>{identity.city}</span>
                    </div>

                    <div class="info-line align-right">
                        <lightning-icon icon-name="utility:topic" size="x-small"></lightning-icon>
                        <span>{identity.source}</span>
                    </div>
                </div>

                <div class="grid-2">
                    <div class="info-line">
                        <lightning-icon icon-name="utility:collection" size="x-small"></lightning-icon>
                        <span>{identity.stage}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Feedback Section -->

            <!-- Duration info -->
            <div class="slds-m-bottom_small slds-grid slds-justify_between">
                <span class="slds-text-title_caps">Last Call Duration:</span>
                <span>{elapsedLabel}</span>
            </div>

            <!-- L1 Picklist -->
            <div class="slds-m-top_small">
                <lightning-combobox
                    name="l1"
                    label="L1 Status"
                    value={l1Value}
                    options={l1Options}
                    onchange={handleL1Change}
                ></lightning-combobox>
            </div>

            <!-- L2 Picklist (dependent) -->
            <div class="slds-m-top_small">
                <lightning-combobox
                    name="l2"
                    label="L2 Sub Status"
                    value={l2Value}
                    options={l2Options}
                    disabled={isL2Disabled}
                    onchange={handleL2Change}
                ></lightning-combobox>
            </div>

            <!-- STAGE -->
            <lightning-combobox
                class="slds-m-top_small text-color"
                name="stage"
                label="Stage"
                value={stageValue}
                options={stageOptions}
                onchange={handleStageChange}>
            </lightning-combobox>

            <!-- COURSE / LEVEL  -->
            <lightning-combobox
                class="slds-m-top_small text-color"
                name="course"
                label="Course"
                value={levelValue}
                options={levelOptions}
                onchange={handleLevelChange}>
            </lightning-combobox>

            <!-- Feedback + Next Follow Up -->
            <div class="slds-box slds-theme_default slds-m-top_small">
                <label class="slds-text-title slds-m-bottom_x-small">
                    Call Feedback
                </label>

              <label class="feedback-label slds-m-top_small">
                Call Feedback
                <template if:true={isCommentMandatory}>
                  <span style="color:#c23934;"> (Mandatory)</span>
                </template>
                <template if:false={isCommentMandatory}>
                  <span style="color:#888;"> (Optional)</span>
                </template>
              </label>
              <lightning-textarea
                value={feedback}
                onchange={handleFeedbackChange}
                placeholder="Write call outcomeâ€¦"
                maxlength="2000">
              </lightning-textarea>


                <div class="slds-m-top_small">
                    <lightning-input
                        type="datetime-local"
                        label="Next Follow Up Date"
                        value={nextFollowUpDate}
                        onchange={handleNextFollowUpDateChange}
                        message-when-bad-input="Please select a valid date"
                    ></lightning-input>
                </div>

                <div class="slds-m-top_small">
                    <lightning-button
                        class="slds-m-left_small"
                        variant="brand"
                        label="Save Feedback"
                        onclick={handleSaveClick}
                        disabled={savingFeedback}
                    ></lightning-button>
                </div>
            </div>
        </template>

        <template if:false={showFeedback}>
            <p class="slds-text-color_weak slds-text-body_small">
                No Runo calls are waiting for feedback.
            </p>
        </template>
    </div>
</template>